<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Makara.Views.ItemsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:behaviors="clr-namespace:Makara.Behaviors.List"
    xmlns:viewmodels="clr-namespace:Makara.ViewModels"
    Title="Items"
    BackgroundColor="White">

    <!--  Grid with explicit row definitions  -->
    <Grid BackgroundColor="White" RowDefinitions="Auto,*">
        <!--  Debug label to show items count  -->
        <Label
            Grid.Row="0"
            Margin="10"
            FontSize="16"
            HorizontalOptions="Center"
            Text="{Binding Items.Count, StringFormat='Items Count: {0}'}" />

        <!--  CollectionView in row 1 (*) which will expand to fill available space  -->
        <CollectionView
            Grid.Row="1"
            Margin="5"
            BackgroundColor="LightGray"
            ItemsSource="{Binding Items}"
            VerticalOptions="FillAndExpand">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <!--  Make each item more visible with a border and padding  -->
                    <Frame
                        Margin="5"
                        Padding="10"
                        BorderColor="Gray"
                        CornerRadius="5"
                        HasShadow="True">
                        <Grid BackgroundColor="White" ColumnDefinitions="*, Auto, Auto, Auto, Auto">

                            <Grid.Behaviors>
                                <!--  Attach behavior to the Grid  -->
                                <behaviors:ListItemActionBehavior Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:ItemsViewModel}}, Path=ItemActionCommand}" Item="{Binding .}" />
                            </Grid.Behaviors>
                            <!--  Attach behavior to the Grid  -->


                            <!--  Make text more visible  -->
                            <Label
                                FontAttributes="Bold"
                                FontSize="18"
                                Text="{Binding Name}"
                                TextColor="Black"
                                VerticalOptions="Center" />

                            <!--  Buttons with visual distinction  -->
                            <Button
                                Grid.Column="1"
                                Margin="2"
                                ClassId="Edit"
                                Text="Edit" />
                            <Button
                                Grid.Column="2"
                                Margin="2"
                                ClassId="Delete"
                                Text="Delete" />
                            <Button
                                Grid.Column="3"
                                Margin="2"
                                ClassId="Share"
                                Text="Share" />
                            <Button
                                Grid.Column="4"
                                Margin="2"
                                ClassId="ViewDetails"
                                Text="Details" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

            <!--  Add visual empty state  -->
            <CollectionView.EmptyView>
                <StackLayout HorizontalOptions="Center" VerticalOptions="Center">
                    <Label
                        FontSize="18"
                        HorizontalTextAlignment="Center"
                        Text="No items available" />
                </StackLayout>
            </CollectionView.EmptyView>
        </CollectionView>
    </Grid>
</ContentPage>